---
title: 分治策略-卷积
date: 2021-09-01 22:52:49
tags: ["算法与数据结构", "algorithms", "data structure", "分治策略"]
categories: "算法"
desc: 分治策略的卷积算法
---

## 卷积及其应用

### 向量计算

给定向量：

- $a=(a_0, a_1, ..., a_{n-1})$

- $b=(b_0, b_1, ..., a_{n-1})$

向量和： $a+b=(a_0+b_0,a_1+b_1,...,a_{n-1}+b_{n-1}$

<!-- more -->

内积： $a \cdot b=a_0b_0+a_1b_1+...+a_{n-1}b_{n-1}$

卷积： $a*b=(c_0,c_1,...,c_{2n-2})$，其中$\large c_k=\sum\limits_{i+j=k \atop i,j<n}a_ib_j, \\ \quad k=0,1,2,...,2n-2$

**卷积**的意义：在下述矩阵中，每个*斜线*的项之和恰好是卷积中的各个分量。

$$
\Large {\begin{array}{cc}
 & \color{blue}{ab_0} & \color{blue}{ab_1} & \color{blue}{...} & \color{blue}{ab_{n-2}} & \color{blue}{ab_{n-1}} \\
\color{blue}{a_0b} & a_0b_0 & a_0b_1 & ... & a_0b_{n-2} & a_0b_{n-1} \\
\color{blue}{a_1b} & a_1b_0 & a_1b_1 & ... & a_1b_{n-2} & a_1b_{n-1} \\
\color{blue}{\vdots} & \vdots & \vdots & & \vdots & \vdots \\
\color{blue}{a_{n-2}b} & a_{n-2}b_0 & a_{n-2}b_1 & ... & a_{n-2}b_{n-2} & a_{n-2}b_{n-1} \\
\color{blue}{a_{n-1}b} & a_{n-1}b_0 & a_{n-1}b_1 & ... & a_{n-1}b_{n-2} & a_{n-1}b_{n-1} \\
\end{array}}
$$

计算实例：

向量：$a=(1,2,4,3),\quad b=(4,2,8,0)$,

则：

- $a+b=(5,3,12,3)$

- $a\cdot b=1\times 4+2\times 2+4\times 8+3\times 0=40$

- $a*b=(4, 10,{\color{red}{28}},36,38,24,0)$

  其中，$28$是这么计算出来的：

  $$
  \large
  \begin{array}{cc}
  & ab_0 & ab_1 & ab_2 & ab_3 \\
  a_0b & 1\times 4 & 1\times 2 & \color{red}{1\times 8} & 1 \times 0 \\
  a_1b & 2\times 4 & \color{red}{2\times 2} & 2 \times 8 & 2\times 0 \\
  a_2b & \color{red}{4\times 4} & 4 \times 2 & 4 \times 8 & 4 \times 0 \\
  a_3b & 3 \times 4 & 3 \times 2 & 3 \times 8 & 3 \times 0 \\
  \end{array}
  $$

**卷积与多项式乘法**的关系

多项式乘法：$C(x)=A(x)B(x)$

$A(x)=a_0+a_1x+a_2x^2+\dots+a_{m-1}x^{m-1}$

$B(x)=b_0+b_1x+b_2x^2+\dots+b_{n-1}x^{n-1}$

$C(x)=a_0b_0+(a_0b_1+a_1b_0)x+\dots+a_{m-1}b_{n-1}x^{m+n-2}$

其中$x^k$的系数

$c_k=\sum\limits_{i+j=k \atop i \in \{0,1,,...,m-1\}, j\in \{0,1,...,n-1\}} a_ib_j,\quad k=0,1,\dots,m+n-2$

### 平滑处理

信号向量：$a=(a_0,a_1,\dots,a_{m-1})$

$b=(b_{2k},b_{2k-1},...,b_0)=(w_{-k},...,w_k)$

$a_i'=\sum_{s=-k}^{k}a_{i+s}b{k-s}=\sum_{s=-k}^{k}a_{i+s}w_s$

把向量$b$看作$2k+1$长度窗口在$a$上移动计算$a*b$，得到$(a_0',a_1',...,a_{m-1}')$。有少数向有误差。

## 卷积计算

## 快速傅里叶变换FFT算法

## 平面点集的凸包
